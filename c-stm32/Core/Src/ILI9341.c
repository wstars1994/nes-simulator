//
// Created by WStars on 2021/8/29.
//

#include <string.h>
#include <nes.h>
#include "ILI9341.h"
#include "spi.h"

//FLASH中存储字符的起始地址
#define FONT_START_ADDR 0x08010000

const unsigned char gImage_di[2048] = {
        0XFF,0XF7,0XFF,0XFF,0XFF,0XFF,0XFC,0XFF,0XF9,0XFF,0XD7,0XFF,0XB5,0XFF,0X94,0XFF,
        0XB5,0XFF,0XD6,0XFF,0XD7,0XFF,0XB7,0XFF,0XB6,0XFF,0XB6,0XFF,0X96,0XFF,0X75,0XFF,
        0X75,0XFF,0X95,0XFF,0XB3,0XFF,0XB3,0XFF,0XB5,0XFF,0XB6,0XFF,0XD5,0XFF,0XB6,0XFF,
        0X97,0XFF,0XB7,0XFF,0XF5,0XFF,0XF7,0XFF,0XFA,0XFF,0XFD,0XFF,0XFF,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XFF,0XFE,0XFF,0XDB,0XFF,0X77,0XFF,0X34,0XFF,0X12,0XFF,0X12,0XFF,
        0XD1,0XF6,0XD2,0XF6,0XD2,0XF6,0XB2,0XF6,0XB2,0XF6,0XB2,0XF6,0XB2,0XFE,0XB1,0XFE,
        0XB2,0XFE,0XB1,0XFE,0XCF,0XFE,0XD0,0XF6,0XD1,0XF6,0XD2,0XEE,0XF2,0XF6,0XD2,0XEE,
        0XF5,0XF6,0XF4,0XF6,0X53,0XF7,0X95,0XFF,0XD9,0XFF,0XFD,0XFF,0XFF,0XFF,0XFF,0XFF,
        0XFF,0XFF,0XFF,0XFF,0XFD,0XFF,0X99,0XFF,0XF4,0XF6,0X91,0XEE,0X90,0XEE,0XB0,0XF6,
        0XD1,0XFE,0XD1,0XFE,0XD1,0XFE,0XB1,0XF6,0XB1,0XF6,0XB1,0XFE,0XD1,0XFE,0XD1,0XFE,
        0XD2,0XFE,0XD1,0XFE,0XF0,0XFE,0XD0,0XFE,0XD2,0XF6,0XF2,0XF6,0XF2,0XF6,0XD2,0XEE,
        0XB3,0XEE,0X93,0XEE,0XD1,0XEE,0X12,0XEF,0X98,0XFF,0XDC,0XFF,0XFF,0XFF,0XFF,0XFF,
        0XDF,0XFF,0XFF,0XFF,0XFC,0XFF,0X78,0XFF,0XD3,0XF6,0X90,0XF6,0XAF,0XFE,0XCF,0XFE,
        0XF0,0XFE,0XF0,0XFE,0XD0,0XFE,0XB0,0XFE,0XB0,0XFE,0XD1,0XFE,0XB0,0XFE,0X90,0XFE,
        0X70,0XFE,0XB0,0XFE,0XCF,0XFE,0XEF,0XFE,0XF2,0XFE,0X12,0XFF,0XF1,0XF6,0XB1,0XEE,
        0X14,0XFF,0XD3,0XF6,0XD0,0XEE,0XF2,0XEE,0X77,0XF7,0XDC,0XFF,0XFF,0XFF,0XDF,0XFF,
        0XDE,0XFF,0XFD,0XFF,0XDB,0XFF,0X36,0XFF,0XD2,0XF6,0XD0,0XFE,0XCF,0XFE,0XEF,0XFE,
        0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XAF,0XFE,0XAF,0XFE,0X8F,0XFE,0X6E,0XFE,0X2D,0XF6,
        0XCD,0XED,0X0E,0XF6,0X8E,0XF6,0XCF,0XFE,0XF1,0XFE,0X33,0XFF,0X11,0XFF,0XB0,0XEE,
        0X75,0XFF,0X34,0XFF,0XF0,0XF6,0XF1,0XEE,0X57,0XF7,0XDC,0XFF,0XFF,0XFF,0XDF,0XFF,
        0XFE,0XFF,0XFD,0XFF,0XBA,0XFF,0X15,0XFF,0XB1,0XF6,0XCF,0XFE,0XCE,0XFE,0XAD,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0X8D,0XFE,0X2D,0XF6,
        0X6C,0XE5,0XED,0XED,0X6D,0XF6,0XCE,0XFE,0X32,0XFF,0X73,0XFF,0X52,0XFF,0XF1,0XFE,
        0X75,0XFF,0X34,0XFF,0XF0,0XF6,0XD0,0XEE,0X56,0XFF,0XDC,0XFF,0XFF,0XFF,0XDF,0XFF,
        0XFE,0XFF,0XFD,0XFF,0XDA,0XFF,0X35,0XFF,0XB1,0XF6,0XAF,0XFE,0XCE,0XFE,0X8C,0XFE,
        0XAD,0XFE,0XAD,0XFE,0XAE,0XFE,0XAE,0XFE,0XAE,0XFE,0XAE,0XFE,0X8D,0XFE,0X2C,0XF6,
        0XAC,0XE5,0X0D,0XF6,0X6D,0XF6,0XAE,0XF6,0XF1,0XFE,0X52,0XFF,0X31,0XFF,0XB0,0XF6,
        0X75,0XFF,0X33,0XFF,0XF0,0XF6,0XD0,0XEE,0X36,0XF7,0XDB,0XFF,0XFF,0XFF,0XDF,0XFF,
        0XFE,0XFF,0XFD,0XFF,0XFB,0XFF,0X35,0XFF,0XB1,0XF6,0XCF,0XFE,0XCE,0XFE,0XCD,0XFE,
        0XEE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XEF,0XFE,0X0F,0XFF,0XEE,0XFE,0XAE,0XFE,
        0X6F,0XFE,0XB0,0XFE,0XCE,0XFE,0XEE,0XFE,0X11,0XFF,0X72,0XFF,0X31,0XFF,0XAF,0XFE,
        0X75,0XFF,0X53,0XFF,0XF0,0XFE,0XD0,0XF6,0X35,0XF7,0XDB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XFF,0XFD,0XFF,0XFB,0XFF,0X36,0XFF,0XB1,0XF6,0X8F,0XF6,0XAE,0XFE,0XCE,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XAF,0XFE,0XAF,0XFE,0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XD0,0XFE,0XCF,0XFE,0XCF,0XFE,
        0X94,0XFF,0X32,0XFF,0X10,0XFF,0XCF,0XF6,0X35,0XF7,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFE,0XFF,0XFB,0XFF,0X56,0XF7,0XD2,0XF6,0XB0,0XF6,0XCF,0XFE,0XCE,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XAF,0XFE,0XAF,0XFE,0XCE,0XFE,0XCD,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,
        0X73,0XFF,0X12,0XFF,0X0F,0XFF,0XCF,0XF6,0X35,0XFF,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XFF,0XFC,0XFF,0X37,0XF7,0XD2,0XF6,0XD0,0XFE,0XCF,0XFE,0XAE,0XFE,
        0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCF,0XFE,
        0XB0,0XFE,0XAF,0XFE,0XCD,0XFE,0XCD,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCF,0XFE,
        0X32,0XFF,0XF1,0XFE,0X0F,0XFF,0XCF,0XF6,0X35,0XFF,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XFF,0XFC,0XFF,0X37,0XF7,0XB2,0XEE,0XD1,0XF6,0XCF,0XFE,0X8E,0XFE,
        0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XEF,0XFE,0XCF,0XFE,
        0XB0,0XFE,0XAF,0XFE,0XCD,0XFE,0XCD,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCF,0XFE,
        0XF1,0XFE,0XD0,0XFE,0X0F,0XFF,0XCF,0XF6,0X35,0XFF,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XFF,0XDC,0XFF,0X57,0XF7,0XD3,0XF6,0XD1,0XFE,0XD0,0XFE,0XCF,0XFE,
        0XAF,0XFE,0XAF,0XFE,0XCF,0XFE,0XD0,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,
        0XB0,0XFE,0XAF,0XFE,0XCE,0XFE,0XCD,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XD0,0XFE,0XB0,0XFE,0XEE,0XFE,0XCF,0XF6,0X35,0XF7,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XFF,0XFD,0XFF,0X99,0XFF,0X14,0XFF,0XD1,0XFE,0XD0,0XFE,0XF0,0XFE,
        0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,
        0XB0,0XFE,0XAF,0XFE,0XCE,0XFE,0XCD,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XB0,0XFE,0XB0,0XFE,0XEE,0XFE,0XCF,0XF6,0X35,0XF7,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XFF,0XFF,0XFF,0XFD,0XFF,0XDA,0XFF,0X14,0XFF,0X4F,0XF6,0X2E,0XF6,0X8E,0XFE,
        0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCF,0XFE,
        0XB0,0XFE,0XAF,0XFE,0XCE,0XFE,0XCD,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XB0,0XFE,0XB0,0XFE,0XEE,0XFE,0XCF,0XEE,0X34,0XF7,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XFF,0XFF,0XFF,0XFD,0XFF,0XFB,0XFF,0XF5,0XFE,0XAE,0XED,0X4B,0XE5,0XAC,0XF5,
        0XAF,0XFE,0XAF,0XFE,0XCF,0XFE,0XCF,0XFE,0XAF,0XFE,0XAF,0XFE,0XCE,0XFE,0XCF,0XFE,
        0XAF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XD0,0XFE,0XAF,0XFE,0XEF,0XFE,0XCF,0XF6,0X35,0XF7,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XFF,0XFF,0XFF,0XFD,0XFF,0XDB,0XFF,0X17,0XFF,0X0E,0XED,0X0C,0XF5,0X2B,0XED,
        0XAF,0XFE,0XCE,0XFE,0XEE,0XFE,0XCE,0XFE,0XAE,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XCE,0XFE,0XAE,0XFE,0XCF,0XFE,0XB0,0XF6,0X35,0XFF,0XFB,0XFF,0XFD,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XF7,0XFE,0XFF,0XDC,0XFF,0XF8,0XFE,0XEE,0XEC,0XED,0XFC,0X0B,0XF5,
        0XAF,0XFE,0XEE,0XFE,0XEE,0XF6,0XEE,0XFE,0XAE,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XCE,0XFE,0XAE,0XFE,0XD0,0XFE,0XB1,0XF6,0X36,0XFF,0XFB,0XFF,0XFD,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XF7,0XFE,0XFF,0XDC,0XFF,0XF8,0XFE,0XEE,0XEC,0XED,0XF4,0X0B,0XF5,
        0XAF,0XFE,0XEE,0XFE,0XEE,0XF6,0XEE,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XCE,0XFE,0X8E,0XFE,0XD0,0XFE,0XB1,0XF6,0X36,0XFF,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XF7,0XFE,0XFF,0XDC,0XFF,0X18,0XFF,0XEE,0XEC,0XED,0XF4,0X0B,0XF5,
        0XAF,0XFE,0XEE,0XFE,0XEE,0XF6,0XEE,0XFE,0XCF,0XFE,0XAF,0XFE,0XB0,0XFE,0XD0,0XFE,
        0XCF,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,
        0XAE,0XFE,0X8E,0XFE,0XD0,0XFE,0XB1,0XF6,0X36,0XFF,0XFC,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XEF,0XFF,0XF7,0XFF,0XFF,0XDC,0XFF,0X18,0XFF,0XEE,0XEC,0X0C,0XF5,0X0B,0XF5,
        0XAE,0XFE,0XEE,0XFE,0XEE,0XF6,0XEE,0XFE,0XCF,0XFE,0XAF,0XFE,0XD0,0XFE,0XD0,0XFE,
        0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAE,0XFE,
        0XAE,0XFE,0X8E,0XFE,0XD1,0XFE,0XB2,0XF6,0X36,0XFF,0XFC,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XEF,0XFF,0XF7,0XFF,0XFF,0XDC,0XFF,0X18,0XFF,0X0E,0XED,0XEC,0XFC,0X0A,0XF5,
        0XAE,0XFE,0XCD,0XFE,0XED,0XFE,0XEE,0XFE,0XCF,0XFE,0XAF,0XFE,0XD0,0XFE,0XD0,0XFE,
        0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAE,0XFE,
        0XAE,0XFE,0X8E,0XFE,0XD0,0XFE,0XB2,0XF6,0X36,0XFF,0XFC,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XF7,0XFE,0XFF,0XDC,0XFF,0X17,0XFF,0X0E,0XED,0X0C,0XFD,0X0A,0XF5,
        0XAD,0XFE,0XCD,0XFE,0XED,0XFE,0XCD,0XFE,0XAE,0XFE,0XAF,0XFE,0XD0,0XFE,0XD0,0XFE,
        0XCF,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAE,0XFE,
        0XAE,0XFE,0X8E,0XFE,0XD0,0XFE,0XB1,0XF6,0X36,0XFF,0XFC,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XFF,0XF7,0XFF,0XF7,0XFE,0XFF,0XDC,0XFF,0X17,0XFF,0X0D,0XED,0X0B,0XFD,0X09,0XF5,
        0X8D,0XFE,0XCD,0XFE,0XCD,0XFE,0XCD,0XFE,0XAE,0XFE,0XAF,0XFE,0XD0,0XFE,0XCF,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCF,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XCE,0XFE,0XAE,0XFE,0XD0,0XFE,0XB1,0XF6,0X36,0XFF,0XFB,0XFF,0XFD,0XFF,0XFF,0XFF,
        0XFF,0XFF,0XFF,0XFF,0XFE,0XFF,0XFC,0XFF,0X17,0XFF,0X4E,0XED,0XCA,0XEC,0X2A,0XF5,
        0XAD,0XFE,0XCD,0XFE,0XCD,0XFE,0XCD,0XFE,0X8E,0XFE,0X8E,0XFE,0XCF,0XFE,0XEF,0XFE,
        0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,0XCF,0XFE,0XCE,0XFE,0XCE,0XFE,0XCE,0XFE,
        0XCD,0XFE,0XCE,0XFE,0XAF,0XFE,0XB1,0XF6,0X36,0XFF,0XFB,0XFF,0XFD,0XFF,0XFE,0XFF,
        0XFF,0XFF,0XFF,0XFF,0XFD,0XFF,0XFC,0XFF,0X17,0XFF,0X4E,0XED,0XEB,0XEC,0X4B,0XFD,
        0XAE,0XFE,0XCD,0XFE,0XCD,0XFE,0XCD,0XFE,0XAE,0XFE,0XAF,0XFE,0XCF,0XFE,0XEF,0XFE,
        0XCD,0XFE,0XCD,0XFE,0XCE,0XFE,0XAE,0XFE,0XAE,0XFE,0XAE,0XFE,0XAD,0XFE,0XAD,0XFE,
        0XAD,0XFE,0XCE,0XFE,0XCF,0XFE,0XD1,0XF6,0X35,0XFF,0XFA,0XFF,0XFD,0XFF,0XFE,0XFF,
        0XDF,0XFF,0XFF,0XFF,0XFD,0XFF,0XFC,0XFF,0X17,0XFF,0X4F,0XED,0XEC,0XE4,0X4B,0XED,
        0X8E,0XFE,0XAE,0XFE,0XAE,0XFE,0XAE,0XFE,0XAE,0XFE,0XAE,0XFE,0XCF,0XFE,0XCE,0XFE,
        0XEE,0XFE,0XEE,0XFE,0XEF,0XFE,0XEF,0XFE,0XEF,0XFE,0XEF,0XFE,0XEE,0XFE,0XEE,0XFE,
        0XAD,0XFE,0XCF,0XFE,0XD0,0XFE,0XD1,0XF6,0X35,0XF7,0XDA,0XFF,0XFD,0XFF,0XFF,0XFF,
        0XDF,0XFF,0XFF,0XFF,0XFE,0XFF,0XFD,0XFF,0X39,0XFF,0XB1,0XE5,0X0D,0XE5,0X0C,0XDD,
        0XB0,0XFE,0XCF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,0XAF,0XFE,0XCF,0XFE,0XCE,0XF6,
        0XCE,0XF6,0XCE,0XF6,0XCE,0XF6,0XCF,0XF6,0XAF,0XF6,0XAF,0XFE,0XAE,0XFE,0XAE,0XFE,
        0XEF,0XFE,0XEF,0XFE,0XD0,0XFE,0XD2,0XF6,0X56,0XF7,0XFB,0XFF,0XFE,0XFF,0XFF,0XFF,
        0XDF,0XFF,0XFF,0XFF,0XDE,0XFF,0XFD,0XFF,0XBB,0XFF,0X76,0XF6,0XD2,0XED,0X6F,0XDD,
        0XD3,0XFE,0XF2,0XFE,0XD1,0XFE,0XD0,0XFE,0XB0,0XFE,0XD0,0XFE,0XD0,0XFE,0XCF,0XF6,
        0XCF,0XFE,0XCF,0XFE,0XD0,0XFE,0XD0,0XFE,0XD0,0XFE,0XD0,0XFE,0XCF,0XFE,0XCF,0XFE,
        0XCF,0XFE,0XAF,0XFE,0X90,0XEE,0XD3,0XEE,0X78,0XFF,0XFD,0XFF,0XFF,0XFF,0XDF,0XF7,
        0XDF,0XFF,0XFF,0XFF,0XDE,0XF7,0XFE,0XFF,0XFD,0XFF,0X5A,0XFF,0XD7,0XFE,0X95,0XF6,
        0XF4,0XF6,0XF3,0XEE,0XD2,0XEE,0XB1,0XF6,0X90,0XFE,0XB0,0XFE,0XAF,0XF6,0XAF,0XF6,
        0XF0,0XF6,0XD0,0XF6,0XD1,0XF6,0XD1,0XF6,0XD1,0XF6,0XD1,0XF6,0XD0,0XFE,0XD0,0XFE,
        0XB0,0XFE,0X90,0XF6,0X91,0XEE,0XF4,0XF6,0X99,0XFF,0XFD,0XFF,0XFF,0XFF,0XFF,0XF7,
        0XDF,0XFF,0XFF,0XFF,0XFF,0XF7,0XFF,0XFF,0XFE,0XFF,0XBD,0XFF,0XBC,0XFF,0XBA,0XFF,
        0X77,0XFF,0X56,0XF7,0X14,0XF7,0XF3,0XF6,0XD2,0XFE,0XF1,0XFE,0X11,0XFF,0XF1,0XF6,
        0XD1,0XF6,0XD1,0XF6,0XD1,0XF6,0XD1,0XF6,0XB2,0XF6,0XB1,0XF6,0XB1,0XFE,0XB1,0XFE,
        0XF2,0XFE,0XF2,0XFE,0X14,0XFF,0X77,0XFF,0XDB,0XFF,0XFE,0XFF,0XFF,0XFF,0XFF,0XF7,
        0XBF,0XFF,0XFF,0XFF,0XFF,0XF7,0XFF,0XF7,0XFF,0XFF,0XBD,0XFF,0XDD,0XFF,0XFC,0XFF,
        0XFB,0XFF,0XF9,0XFF,0XD7,0XFF,0X96,0XFF,0X95,0XFF,0X95,0XFF,0XB4,0XFF,0XB4,0XFF,
        0XB4,0XFF,0X95,0XFF,0X95,0XFF,0X95,0XFF,0X96,0XFF,0X95,0XFF,0X95,0XFF,0X94,0XFF,
        0X74,0XFF,0X95,0XFF,0XB7,0XFF,0XF9,0XFF,0XFC,0XFF,0XFF,0XFF,0XFF,0XFF,0XFF,0XF7,
};

void LCD_SetRegion(uint16_t xStar, uint16_t yStar, uint16_t xEnd, uint16_t yEnd){
    LCD_WR_REG(0x2a);
    LCD_WR_DATA(xStar >> 8);
    LCD_WR_DATA(0x00FF & xStar);
    LCD_WR_DATA(xEnd >> 8);
    LCD_WR_DATA(0x00FF & xEnd);

    LCD_WR_REG(0x2b);
    LCD_WR_DATA(yStar >> 8);
    LCD_WR_DATA(0x00FF & yStar);
    LCD_WR_DATA(yEnd >> 8);
    LCD_WR_DATA(0x00FF & yEnd);

    LCD_WR_REG(0x2C);
}

void LCD_Show_Image(const unsigned char *p) //显示40*40 QQ图片
{
    int i;
    unsigned char picH,picL;

    for(i=0;i<32*32;i++)
    {
        picL=*(p+i*2);	//数据低位在前
        picH=*(p+i*2+1);
        LCD_WR_DATA_16(picH<<8|picL);
    }
}

void ILI9341_Init(void) {
    LCD_RST_CLR;
    HAL_Delay(100);
    LCD_RST_SET;
    HAL_Delay(50);

    LCD_WR_REG(0xCF);   //功耗控制B
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0xD9);
    LCD_WR_DATA(0X30);
    LCD_WR_REG(0xED);   //电源序列控制
    LCD_WR_DATA(0x64);
    LCD_WR_DATA(0x03);
    LCD_WR_DATA(0X12);
    LCD_WR_DATA(0X81);
    LCD_WR_REG(0xE8);   //驱动时序控制A
    LCD_WR_DATA(0x85);
    LCD_WR_DATA(0x10);
    LCD_WR_DATA(0x7A);
    LCD_WR_REG(0xCB);   //功耗控制A
    LCD_WR_DATA(0x39);
    LCD_WR_DATA(0x2C);
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x34);
    LCD_WR_DATA(0x02);
    LCD_WR_REG(0xF7);
    LCD_WR_DATA(0x20);
    LCD_WR_REG(0xEA);   //驱动时序控制B
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x00);
    LCD_WR_REG(0xC0);    //Power control
    LCD_WR_DATA(0x1B);   //VRH[5:0]
    LCD_WR_REG(0xC1);    //Power control
    LCD_WR_DATA(0x12);   //SAP[2:0];BT[3:0] 0x01
    LCD_WR_REG(0xC5);    //VCM control
    LCD_WR_DATA(0x08);     //30
    LCD_WR_DATA(0x26);     //30
    LCD_WR_REG(0xC7);    //VCM control2
    LCD_WR_DATA(0XB7);
    LCD_WR_REG(0x36);    // 存储器访问控制
    LCD_WR_DATA(0x08);
    LCD_WR_REG(0x3A);   //像素格式设置
    LCD_WR_DATA(0x55);
    LCD_WR_REG(0xB1);   //帧速率控制
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x1A);
    LCD_WR_REG(0xB6);    // Display Function Control 显示功能控制
    LCD_WR_DATA(0x0A);
    LCD_WR_DATA(0xA2);
    LCD_WR_REG(0xF2);    // 3Gamma Function Disable 3伽马设置
    LCD_WR_DATA(0x00);
    LCD_WR_REG(0x26);    //Gamma curve selected 伽马曲线选择
    LCD_WR_DATA(0x01);
    LCD_WR_REG(0xE0);    //Set Gamma 正极伽马校准
    LCD_WR_DATA(0x0F);
    LCD_WR_DATA(0x1D);
    LCD_WR_DATA(0x1A);
    LCD_WR_DATA(0x0A);
    LCD_WR_DATA(0x0D);
    LCD_WR_DATA(0x07);
    LCD_WR_DATA(0x49);
    LCD_WR_DATA(0X66);
    LCD_WR_DATA(0x3B);
    LCD_WR_DATA(0x07);
    LCD_WR_DATA(0x11);
    LCD_WR_DATA(0x01);
    LCD_WR_DATA(0x09);
    LCD_WR_DATA(0x05);
    LCD_WR_DATA(0x04);
    LCD_WR_REG(0XE1);    //Set Gamma 负极伽马校准
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x18);
    LCD_WR_DATA(0x1D);
    LCD_WR_DATA(0x02);
    LCD_WR_DATA(0x0F);
    LCD_WR_DATA(0x04);
    LCD_WR_DATA(0x36);
    LCD_WR_DATA(0x13);
    LCD_WR_DATA(0x4C);
    LCD_WR_DATA(0x07);
    LCD_WR_DATA(0x13);
    LCD_WR_DATA(0x0F);
    LCD_WR_DATA(0x2E);
    LCD_WR_DATA(0x2F);
    LCD_WR_DATA(0x05);
    LCD_WR_REG(0x2B);   //行地址设置 0-319
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x01);
    LCD_WR_DATA(0x3f);
    LCD_WR_REG(0x2A);   //列地址设置 0-239
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0x00);
    LCD_WR_DATA(0xef);
    LCD_WR_REG(0x11); //退出睡眠模式
    HAL_Delay(120);
    LCD_WR_REG(0x29); //开始显示
    HAL_Delay(120);

    LCD_SetRegion(0,0,LCD_WIDTH,LCD_HEIGHT);
    LCD_WR_REG(0x36);
    LCD_WR_DATA(0xAc);
    //白色
    LCD_WR_CLEAR(0xFFFF);
}

void LCD_WR_REG(uint8_t reg) {
    LCD_CS_CLR;
    LCD_DC_CLR;
    Spi2_Write_Data(reg);
    LCD_CS_SET;
}

void LCD_WR_DATA(uint8_t data) {
    LCD_CS_CLR;
    LCD_DC_SET;
    Spi2_Write_Data(data);
    LCD_CS_SET;
}

void LCD_WR_DATA_16(uint16_t data) {
    LCD_CS_CLR;
    LCD_DC_SET;
    Spi2_Write_Data_16(data);
    LCD_CS_SET;
}

void LCD_WR_CLEAR(uint16_t color) {
    LCD_SetRegion(0,0,LCD_WIDTH,LCD_HEIGHT);
    LCD_WR_REG(0x2C);
    LCD_CS_CLR;
    LCD_DC_SET;
    for (int i = 0; i < LCD_WIDTH*LCD_HEIGHT; i++) {
        Spi2_Write_Data_16(color);
    }
    LCD_CS_SET;
}

void LCD_WR_POINT(uint16_t color) {
    LCD_CS_CLR;
    LCD_DC_SET;
    Spi2_Write_Data_16(color);
    LCD_CS_SET;
}

void LCD_W_POINT_CONTINUE(uint8_t render[256][3]) {
//    LCD_WR_REG(0x2C);
    for (int w = 0; w < 256; w++) {
        byte pixels[3];
        pixels[0] = render[w][0];
        pixels[1] = render[w][1];
        pixels[2] = render[w][2];
        int rgb = (((pixels[1] >> 2) & 0x3F)<<11) | ((((pixels[0] >> 3) & 0x1F))<<5) | ((pixels[2] >> 3) & 0x1f);
        LCD_WR_POINT(rgb);
    }
}



void LCD_Show_Char(uint8_t p,uint16_t start_x,uint16_t start_y,uint16_t color){
    uint8_t pos,t,temp;
    uint8_t csize = 64;
    for (pos = 0; pos < csize; pos++) {
        //从flash读取
        temp = *(__IO uint8_t*)(FONT_START_ADDR + (p-' ') * csize + pos);
        for (t = 0; t < 8; t++) {
            if (temp & 0x01){
                uint16_t x = start_x+(t+(pos%2)*8);
                uint16_t y = start_y+pos/2;
                //显示点图像
                LCD_SetRegion(x, y,x, y);
                LCD_WR_DATA_16(color);
            }
            temp >>= 1;
        }
    }
}